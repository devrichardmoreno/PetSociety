<section id="register-container-all">
    <div class="logo-background">
        <a routerLink="/" class="back-home-link">
            <span class="back-icon">←</span> Volver al inicio
        </a>
        <img src="/assets/images/logo.svg" alt="Pet Society Logo" id="img-logo">
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
        <h1>Regístrate</h1>

        <div class="input-wrapper">
            <input type="text" class="custom-input" placeholder="Nombre" formControlName="name">
        </div>
        @if (registerForm.get('name')?.errors && registerForm.get('name')?.touched) {
            <div class="error-message">
                @if (registerForm.get('name')?.hasError('required')) {
                    <p class="error-msg">El nombre es obligatorio.</p>
                } @else if (registerForm.get('name')?.hasError('minlength') || registerForm.get('name')?.hasError('maxlength')) {
                    <p class="error-msg">El nombre debe tener entre 2 y 50 caracteres.</p>
                }
            </div>
        }

        <div class="input-wrapper">
            <input type="text" class="custom-input" placeholder="Apellido" formControlName="surname">
        </div>
        @if (registerForm.get('surname')?.errors && registerForm.get('surname')?.touched) {
            <div class="error-message">
                @if (registerForm.get('surname')?.hasError('required')) {
                    <p class="error-msg">El apellido es obligatorio.</p>
                } @else if (registerForm.get('surname')?.hasError('minlength') || registerForm.get('surname')?.hasError('maxlength')) {
                    <p class="error-msg">El apellido debe tener entre 2 y 50 caracteres.</p>
                }
            </div>
        }

        <div class="input-wrapper">
            <input type="text" class="custom-input" placeholder="Teléfono" formControlName="phone">
        </div>
        @if (registerForm.get('phone')?.errors && registerForm.get('phone')?.touched) {
            <div class="error-message">
                @if (registerForm.get('phone')?.hasError('required')) {
                    <p class="error-msg">El teléfono es obligatorio.</p>
                } @else if (registerForm.get('phone')?.hasError('minlength') || registerForm.get('phone')?.hasError('maxlength')) {
                    <p class="error-msg">Debe tener entre 9 y 20 dígitos.</p>
                }
            </div>
        }

        <div class="input-wrapper">
            <input type="text" class="custom-input" placeholder="DNI" formControlName="dni">
        </div>
        @if (registerForm.get('dni')?.errors && registerForm.get('dni')?.touched) {
            <div class="error-message">
                @if (registerForm.get('dni')?.hasError('required')) {
                    <p class="error-msg">El DNI es obligatorio.</p>
                } @else if (registerForm.get('dni')?.hasError('minlength') || registerForm.get('dni')?.hasError('maxlength')) {
                    <p class="error-msg">Debe tener entre 7 y 8 dígitos.</p>
                }
            </div>
        }

        <div class="input-wrapper">
            <input type="email" class="custom-input" placeholder="Email" formControlName="email">
        </div>
        @if (registerForm.get('email')?.errors && registerForm.get('email')?.touched) {
            <div class="error-message">
                @if (registerForm.get('email')?.hasError('required')) {
                    <p class="error-msg">El email es obligatorio.</p>
                } @else if (registerForm.get('email')?.hasError('email')) {
                    <p class="error-msg">El formato del email es incorrecto.</p>
                }
            </div>
        }

        <div class="input-wrapper">
            <input type="text" class="custom-input" placeholder="Nombre de Usuario" formControlName="username">
        </div>
        @if (registerForm.get('username')?.errors && registerForm.get('username')?.touched) {
            <div class="error-message">
                @if (registerForm.get('username')?.hasError('required')) {
                    <p class="error-msg">El nombre de usuario es obligatorio.</p>
                }
            </div>
        }

        <div class="input-wrapper">
            <input type="password" class="custom-input" placeholder="Contraseña" formControlName="password">
        </div>
        @if (registerForm.get('password')?.touched || registerForm.get('password')?.value) {
            <div class="password-requirements">
                <div class="requirement-item" [class.valid]="hasMinLength()" [class.invalid]="!hasMinLength()">
                    <span class="requirement-icon">{{ hasMinLength() ? '✓' : '✗' }}</span>
                    <span class="requirement-text">Debe tener al menos 8 caracteres</span>
                </div>
                <div class="requirement-item" [class.valid]="hasLetter()" [class.invalid]="!hasLetter()">
                    <span class="requirement-icon">{{ hasLetter() ? '✓' : '✗' }}</span>
                    <span class="requirement-text">Debe contener al menos una letra</span>
                </div>
                <div class="requirement-item" [class.valid]="hasNumber()" [class.invalid]="!hasNumber()">
                    <span class="requirement-icon">{{ hasNumber() ? '✓' : '✗' }}</span>
                    <span class="requirement-text">Debe contener al menos un número</span>
                </div>
                <div class="requirement-item" [class.valid]="hasMaxLength()" [class.invalid]="!hasMaxLength()">
                    <span class="requirement-icon">{{ hasMaxLength() ? '✓' : '✗' }}</span>
                    <span class="requirement-text">No puede exceder 50 caracteres</span>
                </div>
            </div>
        }
        @if (registerForm.get('password')?.hasError('required') && registerForm.get('password')?.touched) {
            <div class="error-message">
                <p class="error-msg">La contraseña es obligatoria.</p>
            </div>
        }

        <button class="register-btn" type="submit">
            Crear cuenta
        </button>

        <p class="login-link">
            ¿Ya tienes una cuenta? <a routerLink="/login">Inicia sesión</a>
        </p>
    </form>
</section>