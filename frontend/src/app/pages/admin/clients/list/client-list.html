<div class="client-list-container">
  <h2>Lista de Clientes Activos</h2>

  @if (loading) {
    <p>Cargando clientes...</p>
  } @else if (errorMessage) {
    <p class="error">{{ errorMessage }}</p>
  } @else {
    <div class="search-container">
      <input 
        type="text" 
        class="search-input" 
        placeholder="Buscar por nombre, apellido o nombre completo..."
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
      />
    </div>

    @if (clients.length === 0) {
      <p>No hay clientes registrados.</p>
    } @else if (filteredClients.length === 0) {
      <p>No se encontraron clientes que coincidan con la búsqueda.</p>
    } @else {
      <div class="client-grid">
        @for (client of filteredClients; track client.dni) {
          <div class="client-card">
            <h3>{{ client.name }} {{ client.surname }}</h3>
            <p><strong>DNI:</strong> {{ client.dni }}</p>
            <p><strong>Teléfono:</strong> {{ client.phone }}</p>
            <p><strong>Email:</strong> {{ client.email }}</p>
            <p class="pets-count"><strong>Mascotas:</strong> {{ client.petsCount || 0 }}</p>
            <div class="client-card-actions">
              <button class="btn-edit" (click)="editClient(client)">Editar</button>
              <button class="btn-delete" (click)="unsubscribeClient(client)">Dar de baja</button>
            </div>
            <div class="client-card-pet-actions">
              @if (client.petsCount && client.petsCount > 0) {
                <button class="btn-list-pets" (click)="listClientPets(client)">Listar mascotas</button>
              }
              <button class="btn-add-pet" (click)="addPetToClient(client)">Agregar mascota</button>
            </div>
          </div>
        }
      </div>
    }
  }
</div>

